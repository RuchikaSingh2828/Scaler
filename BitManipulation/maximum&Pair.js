// Problem Description

// Given an array A. For every pair of indices i and j (i != j), find the maximum A[i] & A[j].

// Problem Constraints

// 1 <= len(A) <= 105
// 1 <= A[i] <= 109

// Input Format

// The first argument is an integer array A.

// Output Format

// Return a single integer that is the maximum A[i] & A[j].

// Example Input

// Input 1:-
// A = [53, 39, 88]
// Input 2:-
// A = [38, 44, 84, 12]

// Example Output

// Output 1:-
// 37
// Output 2:-
// 36

// Example Explanation

// Explanation 1:-
// 53 & 39 = 37
// 39 & 88 = 0
// 53 & 88 = 16
// Maximum among all these pairs is 37
// Explanation 2:-
// Maximum bitwise and among all pairs is (38, 44) = 36

// const getMaximumAndPair = (A) => {
//   // Convert the array elements to BigInt to ensure consistency
//   A = A.map(BigInt);
//   let ans = BigInt(0);

//   for (let i = 30; i >= 0; i--) {
//     // Maximum bit position for A[i] <= 10^9 is 30
//     let count = 0n; // Use BigInt for the counter
//     for (const ele of A) {
//       if ((ele & (1n << BigInt(i))) !== 0n) count++;
//     }
//     if (count > 1n) {
//       for (let index = 0; index < A.length; index++) {
//         if ((A[index] & (1n << BigInt(i))) === 0n) A[index] = 0n;
//       }
//       ans += 1n << BigInt(i); // Accumulate the bit value
//     }
//   }
//   return Number(ans); // Convert the result back to Number for output
// };

//! the above code is not working for huge array with bigint numbers

const getMaximumAndPair = (A) => {
  // Convert the array elements to BigInt to ensure consistency
  A = A.map(BigInt);
  let ans = BigInt(0);

  for (let i = 30; i >= 0; i--) {
    // Maximum bit position for A[i] <= 10^9 is 30
    let count = 0n; // Use BigInt for the counter
    for (const ele of A) {
      if ((ele & (1n << BigInt(i))) !== 0n) count++;
    }
    if (count > 1n) {
      for (let index = 0; index < A.length; index++) {
        if ((A[index] & (1n << BigInt(i))) === 0n) A[index] = 0n;
      }
      ans += 1n << BigInt(i); // Accumulate the bit value
    }
  }
  return Number(ans); // Convert the result back to Number for output
};

console.log(getMaximumAndPair([53, 39, 88])); // 37
console.log(getMaximumAndPair([38, 44, 84, 12])); // 36
console.log(getMaximumAndPair([13, 18, 23, 56, 81, 20, 4, 24, 93])); // 81
A: [
  567772166, 91690758, 766552500, 271108283, 228420537, 573014095, 689211341,
  610590690, 507324543, 709837177, 665746335, 498675690, 405772606, 240198057,
  192577525, 967708297, 983295535, 272843109, 226450152, 128137749, 786592491,
  339498549, 815282162, 19410009, 452081701, 179885883, 206192333, 406270460,
  335739865, 295166488, 103447335, 769713422, 989586981, 906010239, 971075596,
  799034390, 34040916, 911735691, 199503663, 628863906, 456483012, 431336874,
  550512397, 966514657, 634939141, 72780880, 91457765, 387549443, 587156178,
  522181166, 694412600, 621271020, 252993727, 384041553, 375521926, 44530962,
  402629570, 367577524, 424383573, 276191914, 583926803, 423258122, 301098693,
  700031872, 226500068, 820058967, 210259109, 956928639, 867773792, 570120821,
  845540128, 278007860, 151629696, 642902974, 141908441, 557809841, 139694734,
  963744322, 765491786, 921019626, 774918167, 109066074, 180914159, 352214680,
  824503551, 668721040, 45704106, 803221752, 765619194, 376722702, 532517824,
  124402807, 230331526, 620992288, 845860175, 897235613, 756236597, 437343510,
  794773290, 782104329, 671837325, 441019371, 493259318, 162850450, 754744470,
  674809018, 199745313, 511732240, 38731735, 494952059, 103990648, 143372720,
  614844927, 926225086, 934702997, 811796606, 441330941, 586957559, 580125072,
  409273896, 987713962, 651749111, 585462769, 191153628, 911781422, 838298569,
  391823250, 538598014, 966438983, 901410660, 509646076, 679207858, 337416013,
  374448582, 373257721, 854182987, 516206002, 179661212, 370892835, 109568562,
  422309832, 47854654, 732478138, 654637373, 106538765, 2893661, 203265249,
  928610458, 261043703, 415003597, 437248369, 378042127, 133693360, 623632915,
  842924813, 260979823, 447262818, 792286385, 241386558, 831631087, 746755084,
  411668598, 925904071, 327653614, 158213062, 773584129, 453352566, 700067195,
  585989609, 494812372, 517224717, 54551012, 403777640, 84002962, 471755470,
  100352958, 962980097, 611804333, 506594403, 947552997, 619035895, 879509885,
  41646719, 980811663, 632838826, 429092329, 216444534, 470933423, 247458270,
  10902514, 72670650, 247830791, 401072890, 991419665, 608598409, 146511162,
  415927842, 986668876, 366213986, 853269582, 380298197, 901062223, 890976767,
  997925555, 280817478, 326206299, 334309757, 289477514, 634496915, 968846862,
  82745483, 691850617, 704857403, 664149701, 472422122, 507660278, 102504187,
  956935781, 37803224, 384965230, 801218607, 672183778, 467924073, 737862072,
  868878809, 172977691, 773998949, 437397304, 616000441, 76382396, 641635959,
  617497164, 19089130, 282737016, 889863098, 562970366, 859926527, 706924184,
  642338191, 448508686, 343814028, 955968634, 11172212, 433559242, 64988330,
  908928753, 780865013, 881266572, 440824536, 257906113, 541751210, 171430693,
  257071336, 830559793, 604945427, 844856344, 478806855, 94046725, 103374348,
  871793553, 883962726, 344776690, 759617354, 549626089, 668560571, 239945207,
  694578898, 670230740, 935089036, 631055398, 204427837, 531600965, 161104881,
  180532993, 545646145, 515928716, 109614987, 338677965, 530799851, 362886850,
  60742524, 977847403, 518325112, 996687937, 800440004, 985198418, 778214144,
  68272107, 683542230, 890286337, 578846219, 668621525, 946632752, 279406858,
  410164461, 612042325, 441939052, 455953508, 640530873, 784733932, 417389209,
  378626682, 968766636, 34554611, 361072935, 648565575, 668232490, 907537913,
  383902907, 561182445, 5740899, 72848844, 186033858, 287604769, 980396131,
  524848474, 695080071, 861308277, 149086829, 681095887, 195357213, 903815922,
  326516529, 491001115, 917606743, 629249328, 154181492, 34565720, 536518976,
  412301129, 54331421, 970557126, 947365467, 643139826, 464486195, 445611404,
  433467164, 585277989, 633508743, 707830646, 938449521, 861120774, 371822752,
  821002307, 528885763, 939385701, 227804233, 512842036, 270382660, 733713751,
  907151187, 154939424, 206820151, 528011636, 614181542, 536562817, 820504847,
  700434314, 67350600, 113275370, 130143702, 262270281, 480524673, 28300860,
  17561073, 512581041, 509729558, 84161474, 806331668, 167574847, 809568555,
  230026714, 738669612, 654406818, 996850990, 364593727, 261724137, 98058289,
  546736836, 633929744, 386838800, 754613705, 740033458, 484767779, 918188907,
  484174265, 370119588, 476127829, 689454493, 507284081, 583062958, 151603709,
  634212098, 777001717, 470419289, 862679446, 722414420, 200251921, 363526459,
  847109306, 846808330, 471795521, 542784588, 707692347, 260083529, 202901808,
  985691745, 129056804, 376805454, 294209880, 465616932, 599456143, 526593474,
  72957013, 922188871, 323547654, 568016792, 20368509, 647963035, 723547205,
  271540035, 350774715, 368931091, 14027887, 34911663, 31712848, 387290798,
  2108533, 5000910, 651366214, 636327253, 402081648, 33352537, 824366851,
  145310032, 444255962, 699808535, 343214389, 787107404, 793431862, 833098471,
  738958270, 8314238, 576528424, 993939590, 454459434, 744084760, 947035251,
  366211994, 534023210, 978586418, 242577393, 326112791, 77558302, 549825625,
  387192727, 636817457, 781147636, 166857097, 831413882, 447067171, 320071049,
  759859470, 203694968, 80925051, 344233835, 890443116, 572796456, 135811808,
  33047064, 16010126, 2975689, 624634214, 61247693, 292574018, 83991417,
  386457187, 959334236, 778632334, 619959339, 263310024, 382356180, 257587845,
  675908293, 255033530, 131865568, 227577929, 845750116, 543356032, 820778880,
  78187253, 143540215, 281638765, 250418396, 751460245, 465623819, 362158355,
  680448411, 891600225, 989341301, 330740997, 546786171, 629978611, 405082729,
  79823265, 834909561, 92448178, 256102726, 215158542, 664196890, 312176054,
  336926858, 886052513, 430261232, 991121598, 556354012, 841814691, 245715972,
  449150094, 935283966, 373917599, 726564299, 681688584, 217443504, 871455502,
  409768354, 334237446, 130555646, 489715138, 968132547, 115811632, 836482508,
  260053044, 952379199, 329051288, 841480789, 907983922, 705235024, 172168161,
  807889249, 453882640, 163419094, 912883586, 81951518, 752061621, 552925494,
  877285354, 218625309, 972769945, 800055063, 565571637, 244820617, 807738153,
  615577620, 821611023, 479143094, 213674409, 273024733, 913674854, 492161322,
  736613635, 494325245, 107709810, 860291123, 928044166, 353546378, 906406775,
  204350309, 976334481, 50163187, 568849111, 392130609, 392722479, 534361410,
  40276910, 697202019, 303730321, 469013279, 7606352, 140924044, 596229196,
  395102553, 878662935, 116926824, 284436946, 984663202, 872311492, 968462725,
  579566227, 353578627, 657167396, 160391861, 116278648, 528861136, 939614810,
  539526963, 87095572, 620133469, 169187701, 504838034, 601720268, 747898784,
  587613760, 105382679, 124103006, 267001003, 182381485, 446925931, 958229340,
  933277939, 560812715, 71638345, 603151241, 89769972, 196401534, 357062208,
  989349997, 258751555, 930906568, 645500135, 387981303, 926577743, 142352171,
  289188474, 237490588, 977953195, 132221979, 374623368, 499688283, 822326195,
  334020595, 15988883, 701666185, 540364737, 502859397, 809060083, 653726814,
  282718757, 301771748, 714629104, 967668289, 167897689, 394504424, 52706753,
  228788772, 278152350, 881590039, 672082896, 2532052, 300861322, 259067373,
  827465461, 122067181, 914610757, 262844965, 835131302, 186703203, 305535359,
  346136664, 176745681, 571836041, 752631908, 595286998, 392670377, 33864328,
  655173760, 783719120, 82105189, 23226839, 818377173, 857247321, 370642566,
  261842774, 582218759, 658051637, 332805333, 946296576, 951495366, 721429480,
  941300451, 806878076, 95187629, 558485310, 83341579, 60238402, 691193121,
  650386243, 305337938, 326550677, 851247329, 258509718, 288824495, 201354046,
  117714433, 703618868, 68376151, 468404316, 294613107, 73012652, 689627912,
  31508045, 861399665, 832933308, 280880225, 263410903, 342095815, 509416185,
  930317915, 980933732, 579765542, 236349356, 815278923, 933910905, 916044466,
  965898182, 212740066, 297353807, 258331818, 513712119, 225730418, 472831391,
  439107735, 542195926, 293219412, 600201173, 942977412, 561323959, 756189855,
  325419401, 550551679, 757604722, 574823491, 876854697, 422536947, 305829708,
  413165943, 335157517, 787715987, 878427199, 148632943, 176397653, 699479152,
  796884837, 972816996, 847750832, 825322524, 680421932, 710024179, 412251345,
  79183914, 835373592, 130955293, 495568338, 892558269, 223283377, 375970159,
  160843589, 70686966, 848031100, 181029856, 181444907, 562369942, 562300954,
  559479977, 733674009, 241604812, 472959839, 687271558, 952824036, 4488594,
  99442400, 453352671, 89011852, 350827892, 768495949, 465389749, 816751672,
  505076419, 950753550, 671333329, 53451028, 106940641, 306244029, 867193524,
  76291842, 634612883, 559955408, 532199661, 678802098, 777971205, 398596425,
  357941607, 143982180, 433069339, 499832287, 281416528, 449558741, 605902679,
  937943103, 85346053, 906110889, 355956801, 570868856, 624846260, 694455336,
  558872377, 976824183, 508029035, 220993500, 598932441, 135882125, 275975219,
  642764331, 833171634, 840771937, 414610981, 214150302, 686475785, 493822487,
  392680940, 271318713, 397250109, 373451993, 624492439, 852844987, 393746164,
  727012046, 182972237, 95785439, 990142228, 919302168, 951702689, 558139286,
  846328370, 65554531, 759498893, 125346491, 843937291, 752098310, 980889100,
  595565778, 432321977, 241053170, 906578467, 921779703, 883936759, 644990273,
  590838215, 41198464, 496730054, 350504815, 635492279, 92712404, 742833410,
  130318021, 27507951, 539901207, 926217975, 748346500, 307066604, 822887512,
  244696650, 948998484, 415380997, 747124056, 801914900, 147704853, 576058653,
  602404403, 730043001, 593798240, 331352079, 83843416, 397561439, 583923048,
  330075785, 338379965, 777609886, 329709412, 287831073, 552746927, 537785008,
  983952033, 77205499, 698154016, 796588047, 464407608, 177782579, 37595369,
  477714591, 682708883, 982609312, 155012538, 615509554, 966561247, 66631143,
  736000693, 289490326, 232738010, 226326278, 245837905, 520422400, 984349960,
  934914207, 333544479, 556658867, 903095929, 94098819, 912497441, 66978198,
  390896670, 478071471, 517527149, 423130442, 20003454, 986215570, 954070614,
  838799254, 697864626, 884077571, 542881767, 813848836, 691540135, 243282556,
  400762056, 103480992, 911267996, 448180781, 551173725, 850208875, 981830838,
  914913553, 457336916, 67003810, 183453240, 836513816, 209995105, 401684545,
  206833814, 14056334, 717661059, 189560973, 882477189, 303929814, 121622167,
  257629891, 116644779, 455249748, 45916710, 16682687, 837769542, 396447015,
  920074267, 17464231, 958978586, 275171931, 747836186, 334556226, 804888252,
  264916571, 357208250, 710953390, 196205042, 716970228, 376333838, 602052982,
  619690557, 805449635, 820532712, 807683289, 369606718, 114005251, 261187872,
  871462590, 91707916, 466755959, 79807629, 175350515, 468703393, 507185777,
  594223788, 725008692, 116519733, 141926047, 488852639, 676096079, 802457816,
  117837211, 27735817, 659846833, 29519645, 800828739, 570915975, 683094580,
  154873501, 662129599, 460813566, 794448429, 222317533, 866648200, 575323485,
  636406219, 262186027, 89201461, 986224932, 146096732, 999439814, 344204782,
  199150202, 105509649,
];
